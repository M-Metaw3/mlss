import{c as C}from"./checkPermission-Ceto9Xa7.js";import{u as N,r,y as I,f as j,h as F,w as i,P as $,x as U,g as _,l as O,o as s,a as b,j as f,c as n,t as u,i as h,b as D,p,q as m,F as X,N as J}from"./index-PF4Eq7D6.js";import{h as L}from"./moment-C5S46NFB.js";import"./hasPermission-CVzDC8fh.js";const R={class:"mb-5 grid grid-cols-12 gap-3 lg:mb-7 lg:gap-5"},H={class:"col-span-12 xl:col-span-7"},G={key:0,class:"flex items-center justify-center rounded-[10px] bg-white py-10 dark:bg-transparent"},K={key:0,class:"flex items-center justify-end"},Q={type:"button",class:"mb-5 rounded-full bg-primary px-7 py-3 text-white"},W=["title"],Z=["href","title"],ee=["title"],ae=["title"],te=["title"],le=["title"],se=["title"],oe={key:2,class:"mt-12"},de={__name:"index",setup(ne){const a=N(),c=$(),Y=U(),y=r(c.query.name||"");I(y,l=>{Y.push({path:"/admin-activity-logs",query:Object.assign({},c.query,{name:l})})});const g=r({columns:[{label:a.t("TITLES.user"),field:"user"},{label:"MLS ID",field:"mls_id"},{label:a.t("TITLES.email"),field:"email"},{label:a.t("TITLES.date"),field:"date"},{label:a.t("TITLES.IP"),field:"ip"},{label:a.t("LABELS.operating"),field:"operating_system"},{label:a.t("LABELS.browser"),field:"browser"},{label:a.t("LABELS.platform"),field:"platform"}],rows:[]}),T=r([]),S=r(0),w=r(c.query.page||1),E=r(0),x=r(0),v=r(!1);async function k(){v.value=!0,await J.post("/admin/user-login-request-header/search",{page:c.query.page||1,page_size:1e4,search_input:c.query.name||"",user:!0,admin:!0}).then(l=>{g.value.rows=l.data.data.data,g.value.rows.map(t=>{const o={};o[a.t("TITLES.user")]=t.user.name,o["MLS ID"]=t.user.mls_id||a.t("TEXTS.notFound"),o[a.t("TITLES.email")]=t.user.email,o[a.t("TITLES.date")]=t.created_at?L(t.created_at).format("YYYY-MM-DD"):a.t("TEXTS.notFound"),o[a.t("TITLES.IP")]=t.ip,o[a.t("LABELS.operating")]=t.operating_system,o[a.t("LABELS.browser")]=t.browser,o[a.t("LABELS.platform")]=t.platform,T.value.push(o)}),E.value=l.data.data.per_page,x.value=l.data.data.last_page,S.value=l.data.data.data.total}).catch(l=>console.error(l)).finally(()=>v.value=!1)}const q=r(!1);async function B(){}return I(()=>c.query,()=>{k()},{deep:!0,immediate:!0}),j(()=>{C("Activity Log search")}),(l,t)=>{const o=_("Search"),V=_("Loader"),A=_("JsonExcel"),M=_("Table"),P=_("Pagination"),z=_("Card"),d=O("tooltip");return s(),F(z,{class:"card-shadow my-5",number:S.value,loading:v.value,onHandleClick:B,disabled:q.value},{default:i(()=>[b("div",R,[b("div",H,[f(o,{disabled:v.value,placeholder:l.$t("INPUTS.activityLogsSearch"),modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e)},null,8,["disabled","placeholder","modelValue"])])]),v.value?(s(),n("div",G,[f(V)])):(s(),n(X,{key:1},[g.value.rows.length?(s(),n("div",K,[f(A,{data:T.value,rtl:h(a).locale.value==="ar",name:"Admin Activity Logs"},{default:i(()=>[b("button",Q,u(l.$t("BUTTONS.exportData")),1)]),_:1},8,["data","rtl"])])):D("",!0),f(M,{"is-slot-mode":!0,columns:g.value.columns,rows:g.value.rows,pagination:!1,"is-hide-paging":!0,class:"font-medium"},{user:i(e=>[p((s(),n("span",{class:"inline-block max-w-[150px] truncate",title:e.value.user.name},[m(u(e.value.user.name),1)],8,W)),[[d]])]),mls_id:i(e=>[b("span",null,u(e.value.user.mls_id||l.$t("TEXTS.notFound")),1)]),email:i(e=>[p((s(),n("a",{href:`mailto:${e.value.user.email}`,class:"inline-block max-w-[150px] truncate",title:e.value.user.email},[m(u(e.value.user.email),1)],8,Z)),[[d]])]),date:i(e=>[p((s(),n("span",{class:"inline-block max-w-[120px] truncate capitalize",title:h(L)(e.value.created_at).format("YYYY-MM-DD")},[m(u(h(L)(e.value.created_at).format("YYYY-MM-DD")),1)],8,ee)),[[d]])]),ip:i(e=>[p((s(),n("span",{class:"inline-block max-w-[120px] truncate capitalize",title:e.value.ip},[m(u(e.value.ip),1)],8,ae)),[[d]])]),operating_system:i(e=>[p((s(),n("span",{class:"inline-block max-w-[120px] truncate capitalize",title:e.value.operating_system},[m(u(e.value.operating_system),1)],8,te)),[[d]])]),platform:i(e=>[p((s(),n("span",{class:"inline-block max-w-[120px] truncate capitalize",title:e.value.platform},[m(u(e.value.platform),1)],8,le)),[[d]])]),browser:i(e=>[p((s(),n("span",{class:"inline-block max-w-[120px] truncate capitalize",title:e.value.browser},[m(u(e.value.browser),1)],8,se)),[[d]])]),_:1},8,["columns","rows"])],64)),x.value>1&&!v.value?(s(),n("div",oe,[f(P,{modelValue:w.value,"onUpdate:modelValue":[t[1]||(t[1]=e=>w.value=e),t[2]||(t[2]=e=>l.$router.push({path:"/admin-activity-logs",query:Object.assign({},h(c).query,{page:w.value})}).then(()=>k()))],pages:x.value,rageSize:E.value,activeColor:""},null,8,["modelValue","pages","rageSize"])])):D("",!0)]),_:1},8,["number","loading","disabled"])}}};export{de as default};
